#!/usr/bin/env bash

jmtpfs "$HOME/etc/phone"
sleep 2
cd "$HOME/etc/phone/Internal shared storage/MIUI/sound_recorder/call_rec"
CALLS=$(find|tail -n +2)
echo "$CALLS"|while read CALL
do
  mv -v "$CALL" "$HOME/etc/root/my/calls"
done
cd "$HOME/etc/phone/Internal shared storage/Download"
SMSXML=$(ls -1t sms-*|head -n 1)
CALLSXML=$(ls -1t calls-*|head -n 1)
mv -v "$CALLSXML" "$HOME/etc/root/my/calls"
mv -v "$SMSXML" "$HOME/etc/root/my/sms"
cd "$HOME"
sudo umount "$HOME/etc/phone"

cd "$HOME/etc/root/my/calls"
echo "$CALLS" "$CALLSXML"|xargs root send
cd "$HOME/etc/root/my/sms"
root send "$SMSXML"
