#!/usr/bin/env bash

TYPE="$1"
COMMAND="$2"

if [ "$TYPE" = "alsa" ]
then
    MAXVOL=$(amixer -c 0 sget "Master"|grep Limits|sed 's/  Limits: Playback 0 - //ig')
    STEP=$(($MAXVOL / 10))
    CURVOL=$(amixer -c 0 cget name="Master Playback Volume"|grep ": values"|sed 's/  : values=//ig'|sed 's/,.*//ig' 2>/dev/null)
    if [ "$COMMAND" == "increase" ]
    then
        if [ "$CURVOL" -lt "$MAXVOL" ]
        then
            CURVOL=$(($CURVOL + $STEP))
        fi
    elif [ "$COMMAND" == "decrease" ]
    then
        if [ "$CURVOL" -gt "0" ]
        then
            CURVOL=$(($CURVOL - $STEP))
        fi
    else
        echo "Error: unknown command $COMMAND"
    fi

    amixer -c 0 sset Master $CURVOL
elif [ "$TYPE" = "pulse" ]
then
    if [ "$COMMAND" = "decrease" ]
    then
        pactl set-sink-mute 0 -- 0
        pactl set-sink-volume 0 -- -10%
    elif [ "$COMMAND" = "increase" ]
    then
        pactl set-sink-mute 0 -- 0
        pactl set-sink-volume 0 -- +10%
    else
        echo "Error: unknown command $COMMAND"
    fi
else
    echo "Error: unknown sound system type $TYPE"
fi
