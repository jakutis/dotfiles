#!/usr/bin/env bash

REPO="$1"

if [ ! -d "$HOME/repos/git/$REPO" ]
then
  (cd "$HOME/repos/git" && git clone "$REPO")
  REPO="${REPO##*/}"
fi

if [ -e "$REPO" ]
then
  echo "Cannot checkout, folder $REPO already exists"
  exit 1
fi

if [ -n "$2" ]
then
  BRANCH="$2"
else
  BRANCH="master"
fi

(cd "$HOME/repos/git/$REPO" && [ "$(git branch --show-current)" = "master" ] && git fetch --all --prune --prune-tags && git rebase origin/master) && cp -r "$HOME/repos/git/$REPO" . && cd "$REPO" && git clean -ffxd . && git checkout "$BRANCH" && ide
